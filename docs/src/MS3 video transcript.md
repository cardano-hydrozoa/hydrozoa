Hi everyone, welcome to Hydrozoa's second video update. 

Today we'll be talking about Milestone 3. 
My name is George Flerovsky and joining me are Ilia Rodionov and Peter Dragos of the Hydrozoa team. 
Today is August 1st, 2025. Let's begin.

So in today's video, we're going to start with a quick recap of Milestone 2's concepts, 
namely the L1 state model and transactions. 

Then we'll talk about L2 ledger and its events, and the L2 blocks. 
We'll have a quick demo and we'll close with the next steps and remaining roadmap of the project. 
If you're interested in the Hydrozoa code base, you can find it at this link. 
And the specification is always kept up to date based on the main branch of the repository at this link. 
So, quick recap. 

Hydrozoa has two regimes. One is called the multi-sig regime, where the assumption that everything is going well, 
the peers are communicating with each other, and they're able to produce new multi-signatures 
to witness the new decisions that they're making in the L2 protocol. 

Whereas the rule-based regime assumes that the peers have lost the ability to collectively follow the protocol 
and not able to produce multi signatures, which means that we need to resolve some sort of dispute between them, 
or figure out what was the last thing that all of them agreed to. So within the multi-sig regime, everything is held 
under a native script that simply says that if all the peers sign, everything is good. 

And in the rule-based regime, the state is held under Plutus scripts, which encode certain on-chain rules 
for how things should move forward. 
The L2 transactions of the two regimes are also different. 
So in today's video, we'll mostly be focusing on the deposit and the settlement transactions. 
If you're interested in the other transactions of the multisig regime, I suggest that you take a look at the previous video. 
The rule-based regime will not really be mentioned at all in today's video, so you can ignore this part, 
but I laid it out here for quick reference if you need it. 

So what is the L2 ledger? Well, it's a private ledger where the peers can move funds between themselves and generally 
interact with each other and they only need to synchronize some of those changes back to L1 if the total balance of funds
in the head changes. In other words, if L1 deposits are absorbed or if the peers are withdrawing some funds from L2. 
Specifically, the L2 ledger consists of a sequence of events of three types, genesis, transactions, and withdrawals. 
And I have color-coded and shape-coded them here in this linear sequence. 
As we move through the sequence, there is a ledger state. 
In other words, the UTXO set and the distribution of those UTXOs among the peers' addresses that gets updated with each event in different ways. 

So let's dive in to each event and talk about what it does specifically. We'll start with the Genesis event. 
This event mirrors the action of the settlement transaction in terms of the deposits being absorbed. 
So as you may recall from the previous video, we have deposit transactions that create these deposit UTXOs. 
Each deposit UTXO UTXO contains some instructions from the depositor about how those deposits should look like on L2 
when they are absorbed, and then those deposit UTXOs are spent in the settlement transaction. 
As a consequence of that, L2 has a genesis event which mirrors that effect of the settlement transaction but on the L2 ledger. 

Specifically, it creates new UTXOs in a one-to-one relationship with the deposit UTXOs, and those new UTXOs 
are created at the deposit address and deposit datum specified in the instructions. 
Now, the Genesis event is not actually manually submitted by any users or peers. 
Instead, it's automatically generated by the L2 consensus, which we will briefly mention at the end of this video 
and go into detail in the Milestone 4 video that we will record very soon. 

So the main workhorse of the L2 Ledger is the transaction event. So this event is very similar to L1. 
You're spending some UTXOs, you can reference some other UTXOs in the L2 Ledger, and you produce some UTXOs. 
And the funds have to be balanced between the spent UTXOs and the produced UTXOs. 
So all of this is familiar stuff for anybody who's worked with transactions on Cardano's L1. 
These transaction events are submitted by users via Hydrazoa's API. 

And the ledger rules governing them are very similar to the ones for L1, except for a few deviations. 
Namely, we don't use staking and governance, because it doesn't make sense on L2. We don't use pre-convey features, 
because we don't need to deal with any legacy ledger state. We don't allow minting or burning of tokens, 
at least within the scope of this catalyst project for Hydrozoa. It may be possible in the future. 
We don't need script collateral because of the nature of L2 consensus. We require inline datums, so no datum hashes. 
We use POSIX times instead of slots. 


Moving on, the last L2 ledger event is withdrawal.
Hydrozoa leverages metadata to distinguish outputs that are L2-bound and outputs that a submitter wants to withdraw.
That way L2 withdrawals are the same transactions, but some outputs may be marked as withdrawn.
L2 ledger rules can take this information into account to validate a transaction that withdraws funds.

So one or more withdrawals events corresponds to a single settlement transactions payout UTXOs and as 
before there is a one-to-one relationship between the withdrawn UTXOs and the payout UTXOs 
where the payout UTXOs address of datum will match that of its mirroring withdrawal withdrawn UTXO on L2. 

So, naively, L2 consensus could be as simple as, you know, you take every L2 event and you gather up the peers 
signatures for it, and then you can consider it to be confirmed. But that's inefficient, because ideally you'd like
to be able to have a whole bunch of events happening at a very high frequency within the head, 
and it would just wouldn't make sense to slow everything down to wait for signatures of a previous event before you 
go on to process the next event. 

So instead, what we do is we gather them up into blocks of events and we get multi signatures for the whole block at a time. 
By the way, Hydrazoa blocks are equivalent to what Hydra calls snapshots. 
So if you're wondering about the terminology. 
The result is less network chatter and more efficiency because we need to gather signatures as frequently. 
Now we distinguish between three types of blocks. We have minor blocks that only contain L2 transactions. 
The reason we set them apart is because L2 transactions on their own don't have any immediate effects on L1 
because they're simply moving around the funds in the L2 ledger without bringing any new deposits in 
or requiring any withdrawal to be paid out on L1. 

So the L2, the minor blocks can simply be kept private between the peers until they decide to close the head essentially. 
The major blocks do contain either a genesis event or one or more withdrawal events. 
And since both of these events are changing total balance of funds within the head, 
this means that a settlement transaction needs to be triggered, 
needs to be sent to L1 to synchronize the effect of these major blocks. 

The last kind of block is the final block. 
It's triggered by a finalization request that one of the peers signals to the rest of the peers. 
It doesn't contain any L2 genesis because the point of the final block is to release all the funds 
from the head according to the latest L2 state in the ledger. 
So correspondingly, the final block triggers a finalization transaction to occur on L1. 
And this is basically all that there is to it for Hydrazoa's ledger state and its L2 blocks, 
at least at a high level, its L2 blocks. 

In the next video, we'll talk more about the specific of the blocks and the L1 effects and the consensus protocol 
about how these blocks get confirmed. But for now, we'll cut the video there and go on to the demo.
